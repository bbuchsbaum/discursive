% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/whm_lda.R
\name{whm_lda}
\alias{whm_lda}
\title{Weighted Harmonic Mean of Trace Ratios for Multiclass Discriminant Analysis}
\usage{
whm_lda(X, labels, m)
}
\arguments{
\item{X}{A numeric matrix of size \code{n x d}, where \code{n} is the number of samples and \code{d} is the number of features.
Rows correspond to samples and columns to features.}

\item{labels}{A vector of length \code{n} containing the class labels of the samples. Can be a factor or a numeric vector.}

\item{m}{The number of dimensions to reduce to, i.e., the number of columns in the projection matrix \eqn{W}.}
}
\value{
A \code{\link[multivarious]{discriminant_projector}} object with:
\itemize{
\item \code{v}: The projection matrix \eqn{W} of size \code{d x m}.
\item \code{s}: The transformed data \eqn{X W} of size \code{n x m}.
\item \code{sdev}: The standard deviations of each column in \code{s}.
\item \code{labels}: The original labels if provided (as a factor).
\item \code{classes}: set to \code{"whm_lda"}.
}
}
\description{
This function implements the Weighted Harmonic Mean of Trace Ratios (WHM-TR) method for
multiclass discriminant analysis as described in the referenced paper. The goal is to find a linear
transformation \eqn{W} that improves class separability by minimizing the weighted harmonic mean of
trace ratios derived from the between-class and within-class scatter matrices.
}
\details{
The algorithm implemented here follows the approach described in Li et al. (2017),
"Beyond Trace Ratio: Weighted Harmonic Mean of Trace Ratios for Multiclass Discriminant Analysis."
The method proceeds as follows:
\enumerate{
\item Compute the between-class (\eqn{S_b}) and within-class (\eqn{S_w}) scatter matrices.
\item Initialize a projection matrix \eqn{W} (of size \code{d x m}) randomly and ensure it is orthonormal.
\item Iteratively update \eqn{W} by minimizing the weighted harmonic mean of trace ratios. This involves:
\itemize{
\item Evaluating pairs of classes and computing partial scatter matrices for each pair.
\item Updating \eqn{W} by solving an eigen-decomposition problem derived from these intermediate matrices.
}
\item Stop when convergence is reached (based on a tolerance) or after a maximum number of iterations.
}

After convergence, \eqn{W} is returned in a standard \code{discriminant_projector} format, along with
the reduced data \eqn{XW} in \code{s}.
}
\examples{
\dontrun{
data(iris)
X <- as.matrix(iris[,1:4])
labels <- iris[,5]
proj <- whm_lda(X, labels, m=2)
print(proj)
# Now you can do:
# new_data <- ...
# projected <- project(proj, new_data)
}

}
\references{
Li, Zhihui, et al. "Beyond Trace Ratio: Weighted Harmonic Mean of Trace Ratios for Multiclass Discriminant Analysis."
\emph{IEEE Transactions on Knowledge and Data Engineering (TKDE)}, 2017.
}
