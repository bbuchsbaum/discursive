% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dpage.R
\name{dgpage_discriminant}
\alias{dgpage_discriminant}
\title{Fit DGPAGE and return a discriminant_projector}
\usage{
dgpage_discriminant(
  X,
  y,
  S = NULL,
  D = NULL,
  r = 2,
  alpha = 0.001,
  beta = 1e-05,
  maxiter = 20,
  tol = 1e-05,
  verbose = TRUE,
  q = 1.5,
  seed = NULL
)
}
\arguments{
\item{X}{A numeric matrix of size n x d (training samples).}

\item{y}{A factor (or coercible to factor) of length n (class labels).}

\item{S}{The n x n similarity graph. If \code{NULL}, we compute it from \code{X,y}.}

\item{D}{The n x n diversity graph. If \code{NULL}, we compute it from \code{X,y}.}

\item{r}{The target dimension (number of discriminant directions).}

\item{alpha, beta}{Hyperparameters in Eq. (12).}

\item{maxiter, tol, verbose}{Passed to \code{\link{dgpage_fit}}.}

\item{q}{If \code{S} or \code{D} is \code{NULL}, we use \code{q} in
\code{\link{compute_similarity_graph}}. Default 1.5.}

\item{seed}{Optional seed passed to \code{dgpage_fit} for reproducibility.}
}
\value{
An object of class \code{c("dgpage_projector","discriminant_projector","bi_projector",...)}
containing:
\itemize{
\item \code{v}        : the d x r loadings
\item \code{s}        : the n x r scores
\item \code{sdev}     : numeric vector of length r with stdevs of columns of s
\item \code{labels}   : the training labels
\item \code{W}        : the learned n x n adjacency graph
\item \code{objective}: final objective value
\item \code{alpha,beta} : stored hyperparameters
}
}
\description{
This function wraps \code{\link{dgpage_fit}} but returns a \code{discriminant_projector}
(subclass \code{"dgpage_projector"}) so that you can use the same \code{predict}
interface as for other discriminant methods.
}
\details{
\strong{Algorithm}:
\enumerate{
\item If \code{S} or \code{D} is \code{NULL}, we build them from \code{X, y}
via \code{compute_similarity_graph} and \code{compute_diversity_graph}.
\item We call \code{\link{dgpage_fit}} to jointly learn the adjacency graph \code{W}
and projection matrix \code{P}.
\item We create a \code{discriminant_projector} object with:
\itemize{
\item \code{v = result$P} (the loadings),
\item \code{s = X \%*\% result\$P} (the training scores),
\item \code{sdev} a vector of stdev per dimension,
\item \code{labels} = \code{y}.
}
We store \code{W} and other metadata in the returned object.
}

\strong{NOTE}: The \code{dgpage_predict} for 1-NN classification can now be replaced by
a new S3 \code{predict} method that lives under \code{dgpage_projector}.
}
\examples{
\dontrun{
  X <- matrix(rnorm(100*5), 100, 5)
  y <- factor(rep(1:2, each=50))
  dp <- dgpage_discriminant(X, y, r=2)
  preds_class  <- predict(dp, new_data=X, method="lda", type="class")
  preds_1nn    <- predict(dp, new_data=X, method="1nn")
  mean(preds_class == y)
  mean(preds_1nn   == y)
}
}
