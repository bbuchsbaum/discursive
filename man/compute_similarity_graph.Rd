% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dpage.R
\name{compute_similarity_graph}
\alias{compute_similarity_graph}
\title{Compute the manual similarity graph S (Eq. (4) in the paper)}
\usage{
compute_similarity_graph(X, y, q = 1.5)
}
\arguments{
\item{X}{A numeric matrix of size \eqn{n \times d}, where each of the \eqn{n} rows is one sample.}

\item{y}{A length-\eqn{n} vector/factor of class labels.}

\item{q}{A positive exponent (see Eqs. (5) and (6)). Typical range is \link{1, 3}.}
}
\value{
An \eqn{n \times n} matrix \eqn{S}.
}
\description{
For each pair of samples \eqn{(x_i, x_j)}, the entry \eqn{s_{ij}} in the similarity
matrix \eqn{S} is computed as:
\deqn{
  s_{ij} =
  \begin{cases}
    \frac{1}{2}\left( e^{-\|x_i - x_j\|^2 / \tau_i^+} + e^{-\|x_j - x_i\|^2 / \tau_j^+} \right), & \text{if } c_i = c_j, \\
    -\frac{1}{2}\left( e^{-\|x_i - x_j\|^2 / \tau_i^-} + e^{-\|x_j - x_i\|^2 / \tau_j^-} \right), & \text{if } c_i \neq c_j,
  \end{cases}
}
where \eqn{\tau_i^+} and \eqn{\tau_i^-} (Eqs. (5) and (6)) characterize the intra- and inter-class
geometric distributions for sample \eqn{x_i}, respectively.
}
\details{
This implementation materializes all pairwise distances and thus has
\eqn{O(n^2)} computational complexity. For very large datasets you may
want to implement a more efficient version, e.g., using Rcpp.
}
